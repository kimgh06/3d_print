# OrcaSlicer 뷰어 기능 구현 가이드

## 개요

OrcaSlicer의 뷰어 기능을 웹 환경에서 구현하기 위한 종합적인 가이드입니다. 이 문서는 각 기능의 구현 방법과 우선순위를 제공합니다.

## 핵심 기능 정의

### 1. 3D 네비게이션 큐브

- **목적**: 직관적인 3D 뷰 네비게이션
- **특징**:
  - Fusion 360 스타일의 상호작용
  - 클릭 및 드래그 지원
  - 부드러운 애니메이션 전환
  - 커스터마이징 가능한 외관

### 2. 캘리퍼 측정 도구

- **목적**: 정밀한 3D 모델 측정 및 스케일링
- **특징**:
  - 두 점 간 거리 측정
  - 정점/모서리/면 스냅 기능
  - 측정값 기반 자동 스케일링
  - 실시간 피드백

### 3. 모델 스케일링 도구

- **목적**: 정확한 모델 크기 조정
- **특징**:
  - 균등/비균등 스케일링
  - 치수 기반 스케일링
  - 실시간 바운딩 박스 표시
  - 종횡비 잠금 기능

### 4. 섹션 분석 도구

- **목적**: 3D 모델의 내부 구조 분석
- **특징**:
  - 절단면 조작
  - 단면 시각화
  - 내부 구조 표시
  - 애니메이션 스위프 기능

### 5. 레이어 프리뷰

- **목적**: 슬라이싱된 모델의 레이어별 미리보기
- **특징**:
  - 레이어별 툴패스 표시
  - 애니메이션 재생
  - 프린팅 분석 도구
  - 문제점 하이라이트

## 구현 우선순위

### Phase 1: 기본 3D 뷰어

1. **3D 모델 로딩 및 표시**

   - STL, OBJ, 3MF 파일 지원
   - 기본 렌더링 (솔리드, 와이어프레임)
   - 카메라 컨트롤 (회전, 줌, 팬)

2. **네비게이션 큐브**

   - 기본 큐브 렌더링
   - 면 클릭 기능
   - 뷰 전환 애니메이션

3. **기본 도구모음**
   - 뷰 리셋
   - 렌더링 모드 전환
   - 기본 변환 도구

### Phase 2: 측정 및 조작 기능

1. **캘리퍼 도구**

   - 두 점 간 거리 측정
   - 기본 스냅 기능
   - 측정값 표시

2. **모델 변환 도구**

   - 이동, 회전, 스케일링
   - 시각적 핸들 표시
   - 수치 입력 지원

3. **모델 정보 패널**
   - 바운딩 박스 정보
   - 모델 통계
   - 변환 히스토리

### Phase 3: 고급 분석 기능

1. **섹션 분석**

   - 절단면 도구
   - 단면 시각화
   - 내부 구조 표시

2. **레이어 프리뷰**

   - G-code 파싱
   - 툴패스 시각화
   - 레이어별 네비게이션

3. **성능 최적화**
   - LOD 시스템
   - 컬링 최적화
   - 메모리 관리

## 기술 스택 권장사항

### 3D 렌더링

- **Three.js**: 웹 기반 3D 렌더링
- **React Three Fiber**: React 통합
- **Drei**: 유틸리티 컴포넌트

### 파일 처리

- **three-stdlib**: 3D 파일 로더
- **3mf-parser**: 3MF 파일 파싱
- **gcode-parser**: G-code 파싱

### UI/UX

- **Tailwind CSS**: 스타일링
- **Headless UI**: 컴포넌트
- **Framer Motion**: 애니메이션

### 상태 관리

- **Zustand**: 간단한 상태 관리
- **Immer**: 불변성 관리

## 주요 구현 고려사항

### 1. 성능 최적화

```typescript
// LOD 시스템 예시
const lodLevels = [
  { distance: 0, triangles: 100000 },
  { distance: 100, triangles: 50000 },
  { distance: 200, triangles: 25000 },
  { distance: 500, triangles: 10000 },
];
```

### 2. 메모리 관리

- 큰 모델 파일의 점진적 로딩
- 텍스처 압축
- 가비지 컬렉션 최적화

### 3. 사용자 경험

- 로딩 상태 표시
- 진행률 표시
- 에러 처리
- 키보드 단축키

### 4. 접근성

- 키보드 네비게이션
- 스크린 리더 지원
- 고대비 모드

## 구현 체크리스트

### 기본 기능

- [ ] 3D 모델 로딩
- [ ] 기본 카메라 컨트롤
- [ ] 네비게이션 큐브
- [ ] 렌더링 모드 전환
- [ ] 기본 도구모음

### 측정 기능

- [ ] 캘리퍼 도구
- [ ] 거리 측정
- [ ] 각도 측정
- [ ] 스냅 기능
- [ ] 측정값 표시

### 모델 조작

- [ ] 이동 도구
- [ ] 회전 도구
- [ ] 스케일링 도구
- [ ] 변환 핸들
- [ ] 수치 입력

### 분석 기능

- [ ] 섹션 분석
- [ ] 레이어 프리뷰
- [ ] 프린팅 분석
- [ ] 문제점 감지

### 고급 기능

- [ ] 플러그인 시스템
- [ ] 상태 관리
- [ ] 실행 취소/다시 실행
- [ ] 설정 저장/로드
- [ ] 내보내기 기능

## 사용 예시

```tsx
import { OrcaViewer } from "./features/orca-viewer/OrcaViewer";

function App() {
  return (
    <div className="h-screen w-screen">
      <OrcaViewer
        config={{
          viewer: {
            renderMode: "solid",
            backgroundColor: "#f0f0f0",
            showGrid: true,
            showAxes: true,
          },
          navigation: {
            enableNavigationCube: true,
            enablePanZoom: true,
            enableRotation: true,
          },
          measurement: {
            enableCaliper: true,
            measurementPrecision: 2,
            measurementColor: "#ff0000",
          },
        }}
        onModelLoad={(model) => console.log("Model loaded:", model)}
        onMeasurementComplete={(measurement) =>
          console.log("Measurement:", measurement)
        }
      />
    </div>
  );
}
```

## 다음 단계

1. **기본 뷰어 구현**: Three.js 기반 3D 뷰어 생성
2. **네비게이션 큐브**: 상호작용 가능한 네비게이션 큐브 추가
3. **측정 도구**: 캘리퍼 도구 및 측정 기능 구현
4. **고급 기능**: 섹션 분석 및 레이어 프리뷰 추가
5. **성능 최적화**: LOD 및 컬링 시스템 구현

이 가이드를 따라 단계별로 구현하면 OrcaSlicer와 유사한 고품질 3D 뷰어를 만들 수 있습니다.
